# è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® - æ™ºèƒ½ä½“ç³»ç»Ÿå®Œæ•´éƒ¨ç½²æŒ‡å—

**ç‰ˆæœ¬**: v5.0 ç”Ÿäº§è¿è¡Œç‰ˆ  
**æœ€åæ›´æ–°**: 2025-10-26 16:45  
**çŠ¶æ€**: âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è§ˆ](#ç³»ç»Ÿæ¦‚è§ˆ)
2. [ä¸‰å¤§æ™ºèƒ½ä½“å¯¹æ¯”](#ä¸‰å¤§æ™ºèƒ½ä½“å¯¹æ¯”)
3. [DQAç³»ç»Ÿè¯¦è§£](#dqaç³»ç»Ÿè¯¦è§£)
4. [ç¿»è¯‘æ™ºèƒ½ä½“è¯¦è§£](#ç¿»è¯‘æ™ºèƒ½ä½“è¯¦è§£)
5. [è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“è¯¦è§£](#è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“è¯¦è§£)
6. [éƒ¨ç½²ä¸é…ç½®](#éƒ¨ç½²ä¸é…ç½®)
7. [æ™ºèƒ½ä½“ä¿æŒå¯åŠ¨è§„å®š](#æ™ºèƒ½ä½“ä¿æŒå¯åŠ¨è§„å®š)
8. [ç®¡ç†å‘½ä»¤](#ç®¡ç†å‘½ä»¤)
9. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## ç³»ç»Ÿæ¦‚è§ˆ

æœ¬é¡¹ç›®åŒ…å«**ä¸‰ä¸ªç‹¬ç«‹çš„æ™ºèƒ½ä½“ç³»ç»Ÿ**ï¼ŒååŒå·¥ä½œä¸ºåŒ»ç¾çŸ¥è¯†åº“æä¾›å®Œæ•´çš„ç”Ÿæˆã€ç¿»è¯‘ã€è´¨é‡æ£€æŸ¥æœåŠ¡ã€‚

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±•ç¤ºç³»ç»Ÿ                              â”‚
â”‚            http://47.237.79.9:5001/knowledge               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†‘
                   database.sqlite
                   (å‰ç«¯é—®ç­”æ•°æ®åº“)
                          â†‘
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                â”‚                 â”‚             â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚ DQAç³»ç»Ÿ   â”‚     â”‚ç¿»è¯‘æ™ºèƒ½ä½“ â”‚   â”‚ è´¨é‡æ£€æŸ¥    â”‚
    â”‚ v1.5.0    â”‚     â”‚ v3.0      â”‚   â”‚ v1.0       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚                 â”‚
    122å®¶åŒ»é™¢       1,829æ¡ä¸­æ–‡é—®ç­”    æ£€æŸ¥ä¸ä¿®æ­£
   (è‡ªåŠ¨ç”Ÿæˆ)      (å‡åŒ€åˆ†å¸ƒç¿»è¯‘)    (æŒç»­ä¼˜åŒ–)
                                           â†“
                                      medical.db
                                   (æ™ºèƒ½ä½“è®­ç»ƒåº“)
```

---

## ä¸‰å¤§æ™ºèƒ½ä½“å¯¹æ¯”

### æ ¸å¿ƒæŒ‡æ ‡

| ç‰¹æ€§ | DQAç³»ç»Ÿ | ç¿»è¯‘æ™ºèƒ½ä½“ | è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“ |
|------|---------|----------|----------------|
| **ç‰ˆæœ¬** | v1.5.0 | v3.0 | v1.0 |
| **è„šæœ¬æ–‡ä»¶** | `backend/src/dqa/dqaGenerator.js` | `scripts/qa_translator_agent.py` | `scripts/qa_quality_checker.py` |
| **ä¸»è¦åŠŸèƒ½** | ç”ŸæˆåŒ»é™¢é—®ç­” | ç¿»è¯‘ä¸­æ–‡ä¸ºè¶Šå—è¯­ | æ£€æŸ¥å’Œä¿®æ­£è´¨é‡é—®é¢˜ |
| **æ•°æ®æº** | 122å®¶åŒ»é™¢ | medical.db (1,829æ¡) | database.sqlite + medical.db |
| **è¾“å‡ºè¯­è¨€** | è¶Šå—è¯­ | è¶Šå—è¯­ (100%çº¯) | è¶Šå—è¯­ (ä¿®æ­£) |
| **è¿è¡Œé¢‘ç‡** | æ¯15åˆ†é’Ÿ1æ¡ | æ¯15åˆ†é’Ÿ1æ¡ | æ‰‹åŠ¨è§¦å‘/å®šæœŸæ£€æŸ¥ |
| **æ—¥äº§é‡** | 96æ¡/å¤© | 96æ¡/å¤© | æŒ‰éœ€æ£€æŸ¥ |
| **ä½¿ç”¨æŠ€æœ¯** | æ¨¡æ¿+éšæœº | LLMç¿»è¯‘ | LLMæ£€æŸ¥ä¿®æ­£ |
| **è´¨é‡ä¿è¯** | æ‹ŸäººåŒ–è¡¨è¾¾ | å‡åŒ€åˆ†å¸ƒ | è‡ªåŠ¨ä¿®æ­£é—®é¢˜ |

### åŠŸèƒ½åˆ†å·¥

**DQAç³»ç»Ÿ v1.5.0**:
- âœ… åŸºäº122å®¶åŒ»é™¢æ•°æ®ç”Ÿæˆé—®ç­”
- âœ… 15ç§å¼€åœºç™½ + 10ç§ç»“å°¾è¯­ + 14ç§è¿‡æ¸¡è¯
- âœ… 6ç§é—®ç­”ç±»å‹ (èµ„è´¨ã€ç­‰çº§ã€æœåŠ¡ã€åœ°å€ã€è”ç³»ã€åŒ»ç”Ÿ)
- âœ… åŒ»é™¢å’¨è¯¢ä¸“å±åˆ†ç±»

**ç¿»è¯‘æ™ºèƒ½ä½“ v3.0**:
- âœ… 1,829æ¡ä¸­æ–‡é—®ç­”ç¿»è¯‘
- âœ… 5å¤§åˆ†ç±»å‡åŒ€åˆ†å¸ƒ
- âœ… 100%çº¯è¶Šå—è¯­ (ä¸­æ–‡æ£€æµ‹+è‡ªåŠ¨æ¸…ç†)
- âœ… 5æ¬¡é‡è¯•æœºåˆ¶

**è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“ v1.0**:
- âœ… å‡†ç¡®æ€§æ£€æŸ¥
- âœ… ä¸€è‡´æ€§æ£€æŸ¥
- âœ… å®Œæ•´æ€§æ£€æŸ¥
- âœ… è‡ªåŠ¨ä¿®æ­£é—®é¢˜
- âœ… å†å²è®°å½•è¿½è¸ª
- âœ… è´¨é‡è¯„åˆ†ç³»ç»Ÿ

---

## DQAç³»ç»Ÿè¯¦è§£

### åŸºæœ¬ä¿¡æ¯

**åç§°**: Dynamic Q&A Generator (v1.5.0 æ‹ŸäººåŒ–ä¼˜åŒ–ç‰ˆ)  
**æ–‡ä»¶**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/src/dqa/dqaGenerator.js`  
**è¯­è¨€**: JavaScript (Node.js)  
**å¯åŠ¨æ–¹å¼**: éšåç«¯è‡ªåŠ¨å¯åŠ¨

### æ ¸å¿ƒä¼˜åŒ– (v1.5.0)

#### 1. æ‹ŸäººåŒ–ä¼˜åŒ–

**15ç§ä¸ªæ€§åŒ–å¼€åœºç™½**:
```javascript
[
  "ChÃ o báº¡n!",
  "Báº¡n Æ¡i,",
  "MÃ¬nh cÃ³ thá»ƒ giÃºp báº¡n...",
  // ... 12 more variations
]
```

**10ç§æ¸©é¦¨ç»“å°¾è¯­**:
```javascript
[
  "Hy vá»ng Ä‘iá»u nÃ y giÃºp Ã­ch cho báº¡n nhÃ©!",
  "Náº¿u báº¡n cÃ³ thÃªm cÃ¢u há»i...",
  // ... 8 more variations
]
```

**14ç§è‡ªç„¶è¿‡æ¸¡è¯**:
```javascript
[
  "NgoÃ i ra,",
  "NhÆ° váº­y,",
  "Äá»ƒ báº¡n hiá»ƒu rÃµ hÆ¡n,",
  // ... 11 more variations
]
```

#### 2. é—®ç­”ç±»å‹

1. **åŒ»é™¢èµ„è´¨é—®ç­”** - åŒ»é™¢æ˜¯å¦åˆæ³•ã€è¯ä»¶æ˜¯å¦é½å…¨
2. **åŒ»é™¢ç­‰çº§é—®ç­”** - åŒ»é™¢çš„ç­‰çº§ã€è®¤è¯æƒ…å†µ
3. **åŒ»é™¢æœåŠ¡é—®ç­”** - åŒ»é™¢æä¾›çš„åŒ»ç¾æœåŠ¡é¡¹ç›®
4. **åŒ»é™¢åœ°å€é—®ç­”** - åŒ»é™¢å…·ä½“ä½ç½®ã€åˆ†é™¢ä¿¡æ¯
5. **åŒ»é™¢è”ç³»æ–¹å¼** - å’¨è¯¢ç”µè¯ã€é¢„çº¦æ–¹å¼ã€å·¥ä½œæ—¶é—´
6. **åŒ»ç”Ÿå›¢é˜Ÿé—®ç­”** - åŒ»ç”Ÿä¸“ä¸šèµ„è´¨ã€ç»éªŒä»‹ç»

#### 3. æ•°æ®æº

- **åŒ»é™¢æ•°é‡**: 122å®¶
- **æ•°æ®ç»´åº¦**: èµ„è´¨ã€æœåŠ¡ã€åŒ»ç”Ÿã€è®¾æ–½ç­‰
- **æ•°æ®å®Œæ•´åº¦**: 100%è¦†ç›–
- **æ›´æ–°é¢‘ç‡**: å®æ—¶åŒæ­¥

### DQAç³»ç»Ÿä½¿ç”¨

#### æŸ¥çœ‹çŠ¶æ€

```bash
# APIæŸ¥è¯¢
curl http://localhost:5002/api/dqa/stats

# æ•°æ®åº“æŸ¥è¯¢
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM knowledge WHERE source='dqa';"

# æŸ¥çœ‹æœ€è¿‘ç”Ÿæˆ
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT created_at, category, substr(question, 1, 50) \
   FROM knowledge WHERE source='dqa' \
   ORDER BY created_at DESC LIMIT 5;"
```

#### ç”Ÿæˆç¤ºä¾‹

**è¾“å…¥æ•°æ®**:
- åŒ»é™¢: FV Hospital
- èµ„è´¨: å›½é™…JCIè®¤è¯
- æœåŠ¡: éš†èƒ¸ã€é¢éƒ¨æ•´å½¢

**ç”Ÿæˆé—®é¢˜**:
```
Bá»‡nh viá»‡n FV Hospital cÃ³ nhá»¯ng giáº¥y phÃ©p nÃ o?
```

**ç”Ÿæˆç­”æ¡ˆ**:
```
ChÃ o báº¡n! MÃ¬nh ráº¥t vui Ä‘Æ°á»£c tÆ° váº¥n cho báº¡n vá» giáº¥y phÃ©p cá»§a 
Bá»‡nh viá»‡n FV Hospital. Bá»‡nh viá»‡n cÃ³ Ä‘áº§y Ä‘á»§ giáº¥y phÃ©p hoáº¡t Ä‘á»™ng, 
bao gá»“m chá»©ng chá»‰ JCI quá»‘c táº¿... Hy vá»ng thÃ´ng tin nÃ y há»¯u Ã­ch 
cho báº¡n nhÃ©!
```

---

## ç¿»è¯‘æ™ºèƒ½ä½“è¯¦è§£

### åŸºæœ¬ä¿¡æ¯

**åç§°**: QA Translator Agent (v3.0 å‡åŒ€åˆ†å¸ƒä¼˜åŒ–ç‰ˆ)  
**æ–‡ä»¶**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py`  
**è¯­è¨€**: Python 3.7+  
**å¤§æ¨¡å‹**: Doubao-Seed-1.6-flash (è±†åŒ…Flashæ¨¡å‹)

### æ ¸å¿ƒä¼˜åŒ– (v3.0)

#### 1. 100%çº¯è¶Šå—è¯­ä¿è¯

**ä¸­æ–‡æ£€æµ‹æœºåˆ¶**:
```python
def contains_chinese(text: str) -> bool:
    chinese_pattern = re.compile(r'[\u4e00-\u9fff]+')
    return bool(chinese_pattern.search(text))
```

**è‡ªåŠ¨æ¸…ç†å‡½æ•°**:
```python
def clean_chinese_from_text(text: str) -> str:
    replacements = {
        'å‡ä½“': 'implant',
        'æ™®æ‹‰æ': 'Pilates',
        'éš†é¼»': 'nÃ¢ng mÅ©i',
        'åŒçœ¼çš®': 'máº¯t mÃ­ kÃ©p',
        # ... æ›´å¤šæ˜ å°„
    }
    # å…ˆæ›¿æ¢å·²çŸ¥æœ¯è¯­ï¼Œå†ç§»é™¤å‰©ä½™ä¸­æ–‡
```

**5æ¬¡é‡è¯•æœºåˆ¶**: ç¡®ä¿è´¨é‡

#### 2. 5å¤§ç±»å‡åŒ€åˆ†å¸ƒ

**åˆ†å¸ƒç®—æ³•**:
```python
# ç»Ÿè®¡å„åˆ†ç±»å·²ç¿»è¯‘æ•°é‡
category_counts = {
    'ä¸°èƒ¸': 32,
    'äº”å®˜': 3,
    'äº§ä¿®': 1,
    'å¸è„‚': 0,
    'ç‰™çŸ«': 0
}

# æ‰¾å‡ºç¿»è¯‘æœ€å°‘çš„åˆ†ç±»
min_count = 0  # å¸è„‚å’Œç‰™çŸ«éƒ½æ˜¯0
least_categories = ['å¸è„‚', 'ç‰™çŸ«']

# ä¼˜å…ˆä»è¿™ä¸¤ä¸ªåˆ†ç±»ä¸­é€‰æ‹©
```

**åˆ†ç±»æ˜ å°„**:

| ä¸­æ–‡ | å‰ç«¯è¶Šå—è¯­æ ‡ç­¾ | è‹±æ–‡è¯´æ˜ | é—®ç­”æ•° |
|------|----------|------|-------|
| ä¸°èƒ¸ | **Tháº©m má»¹ ngá»±c** | Breast Aesthetics | 381 |
| äº”å®˜ | **Tháº©m má»¹ khuÃ´n máº·t** | Facial Aesthetics | 500 |
| äº§ä¿® | **Phá»¥c há»“i sau sinh** | Postpartum Recovery | 201 |
| å¸è„‚ | **HÃºt má»¡ táº¡o dÃ¡ng** | Liposuction & Body Contouring | 298 |
| ç‰™çŸ« | **Niá»ng rÄƒng** | Orthodontics | 449 |

#### 3. ç¿»è¯‘æµç¨‹

1. **å‡åŒ€é€‰æ‹©**: ä¼˜å…ˆé€‰æœ€å°‘åˆ†ç±»çš„é—®ç­”
2. **APIç¿»è¯‘**: è°ƒç”¨è±†åŒ…æ¨¡å‹
3. **JSONè§£æ**: è‡ªåŠ¨ä¿®å¤æ ¼å¼
4. **ä¸­æ–‡æ£€æµ‹**: å‘ç°ä¸­æ–‡æ®‹ç•™
5. **è‡ªåŠ¨æ¸…ç†**: æ›¿æ¢å·²çŸ¥æœ¯è¯­
6. **é‡è¯•éªŒè¯**: æœ€å¤š5æ¬¡
7. **ä¿å­˜æ•°æ®åº“**: æ›´æ–°å‰ç«¯æ•°æ®åº“
8. **è®°å½•è¿›åº¦**: é¿å…é‡å¤

---

## è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“è¯¦è§£

### åŸºæœ¬ä¿¡æ¯

**åç§°**: QA Quality Checker Agent (v1.0)  
**æ–‡ä»¶**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_quality_checker.py`  
**è¯­è¨€**: Python 3.6+  
**å¤§æ¨¡å‹**: Doubao-Seed-1-6-251015 (è±†åŒ…æ¨¡å‹)

### æ ¸å¿ƒåŠŸèƒ½

#### 1. æ£€æŸ¥ç»´åº¦

**5å¤§æ£€æŸ¥ç»´åº¦**:

| ç»´åº¦ | è¯´æ˜ | ä¸¥é‡ç¨‹åº¦ |
|------|------|----------|
| `accuracy` | åŒ»å­¦ä¿¡æ¯å‡†ç¡®æ€§ | âš ï¸ é«˜ |
| `consistency` | é—®ç­”åŒ¹é…åº¦ | âš ï¸ é«˜ |
| `completeness` | å†…å®¹å®Œæ•´æ€§ | âš ï¸ ä¸­ |
| `clarity` | è¡¨è¾¾æ¸…æ™°åº¦ | â„¹ï¸ ä½ |
| `safety` | å®‰å…¨æé†’ | âš ï¸ é«˜ |

#### 2. è´¨é‡è¯„åˆ†

**åˆ†æ•°ä½“ç³»**:

| åˆ†æ•° | è¯„çº§ | è¯´æ˜ |
|------|------|------|
| 90-100 | ä¼˜ç§€ | æ— æ˜æ˜¾é—®é¢˜ |
| 80-89 | è‰¯å¥½ | è½»å¾®é—®é¢˜ |
| 70-79 | ä¸€èˆ¬ | ä¸­ç­‰é—®é¢˜ï¼Œå»ºè®®ä¿®æ­£ |
| 60-69 | è¾ƒå·® | æ˜æ˜¾é—®é¢˜ï¼Œéœ€è¦ä¿®æ­£ |
| 0-59 | å¾ˆå·® | ä¸¥é‡é—®é¢˜ï¼Œå¿…é¡»ä¿®æ­£ |

#### 3. è‡ªåŠ¨ä¿®æ­£åŠŸèƒ½

**ä¿®æ­£ç±»å‹**:
- åŒ»å­¦æœ¯è¯­å‡†ç¡®æ€§
- ç­”æ¡ˆå®Œæ•´æ€§è¡¥å……
- å®‰å…¨æé†’æ·»åŠ 
- è¡¨è¾¾é€»è¾‘ä¼˜åŒ–

#### 4. æ•°æ®åº“è¿½è¸ª

**å†å²è®°å½•è¡¨**:
```sql
CREATE TABLE knowledge_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    knowledge_id INTEGER NOT NULL,
    old_answer TEXT,
    new_answer TEXT,
    issues TEXT,
    modified_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (knowledge_id) REFERENCES knowledge (id)
);
```

### ä½¿ç”¨æ–¹æ³•

#### å¿«é€Ÿä½¿ç”¨

```bash
# å¿«é€Ÿæ£€æŸ¥æ‰€æœ‰é—®ç­”
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®
./scripts/quick_qa_check.sh

# æŒ‡å®šæ•°æ®åº“
python3 scripts/qa_quality_checker.py --db-path backend/data/medical.db

# è®¾ç½®æ‰¹å¤„ç†å‚æ•°ï¼ˆæ¨èå°æ‰¹é‡ï¼‰
python3 scripts/qa_quality_checker.py --batch-size 3 --delay 2.0

# åªæ£€æŸ¥ç‰¹å®šåˆ†ç±»
python3 scripts/qa_quality_checker.py --category ä¸°èƒ¸
```

#### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--db-path` | æ•°æ®åº“è·¯å¾„ | `/root/.../backend/data/medical.db` |
| `--batch-size` | æ‰¹å¤„ç†å¤§å° | 5 |
| `--delay` | æ‰¹æ¬¡é—´å»¶è¿Ÿ(ç§’) | 2.0 |
| `--category` | æŒ‡å®šåˆ†ç±» | æ—  |

---

## éƒ¨ç½²ä¸é…ç½®

### ç¯å¢ƒè¦æ±‚

**ç¡¬ä»¶**:
- CPU: 2æ ¸+
- å†…å­˜: 2GB+
- å­˜å‚¨: 50GB+
- ç½‘ç»œ: ç¨³å®šè¿æ¥

**è½¯ä»¶**:
- Node.js 14+
- Python 3.7+
- SQLite3
- Shell bash

### éƒ¨ç½²æ­¥éª¤

#### 1. DQAç³»ç»Ÿéƒ¨ç½²

```bash
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨åç«¯ï¼ˆè‡ªåŠ¨å¯åŠ¨DQAï¼‰
npm start

# éªŒè¯å¯åŠ¨
curl http://localhost:5002/api/dqa/stats
```

#### 2. ç¿»è¯‘æ™ºèƒ½ä½“éƒ¨ç½²

```bash
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®

# å®‰è£…Pythonä¾èµ–
pip install requests sqlite3 re logging

# æ¸…é™¤ä»£ç†é…ç½®
unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY

# å¯åŠ¨ç¿»è¯‘æ™ºèƒ½ä½“ï¼ˆæ¯15åˆ†é’Ÿ1æ¡ï¼‰
nohup python3 scripts/qa_translator_agent.py --interval 15 \
  > logs/qa_translator_background.log 2>&1 &

# éªŒè¯å¯åŠ¨
ps aux | grep qa_translator_agent
```

#### 3. è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“éƒ¨ç½²

```bash
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p logs

# ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x scripts/qa_quality_checker.py
chmod +x scripts/quick_qa_check.sh

# éªŒè¯APIè¿æ¥
python3 scripts/test_doubao_api.py

# å¿«é€Ÿæ£€æŸ¥æµ‹è¯•
./scripts/quick_qa_check.sh

# å®šæœŸæ£€æŸ¥ï¼ˆå»ºè®®æ·»åŠ åˆ°crontabï¼‰
# æ¯å‘¨æ—¥2:00è¿è¡Œ
0 2 * * 0 cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®&& python3 scripts/qa_quality_checker.py >> logs/cron.log 2>&1
```

### é…ç½®è¯´æ˜

#### DQAç³»ç»Ÿé…ç½®

**æ–‡ä»¶**: `backend/config/dqa.config.js`

```javascript
{
  // æ‹ŸäººåŒ–é…ç½®
  humanization: {
    enableGreetings: true,      // ä¸ªæ€§åŒ–å¼€åœº
    enableClosings: true,        // æ¸©é¦¨ç»“å°¾
    enableTransitions: true,     // è‡ªç„¶è¿‡æ¸¡
    temperature: 0.7             // åˆ›æ„ç¨‹åº¦
  },
  
  // ç”Ÿæˆé…ç½®
  generation: {
    batchSize: 1,                // æ¯æ‰¹ç”Ÿæˆæ•°
    delayBetween: 900000,        // é—´éš”15åˆ†é’Ÿ(æ¯«ç§’)
    maxRetries: 3                // æœ€å¤§é‡è¯•æ¬¡æ•°
  },
  
  // æ•°æ®æºé…ç½®
  dataSource: {
    hospitalCount: 122,
    includeServices: true,
    includeTeam: true
  }
}
```

#### ç¿»è¯‘æ™ºèƒ½ä½“é…ç½®

**æ–‡ä»¶**: `scripts/qa_translator_agent.py` (ç¬¬1-50è¡Œ)

```python
# APIé…ç½®
API_URL = "https://ark.cn-beijing.volces.com/api/v3/chat/completions"
API_KEY = "your_api_key"
MODEL = "doubao-seed-1-6-flash"

# æ•°æ®åº“é…ç½®
MEDICAL_DB = "/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db"
FRONTEND_DB = "/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite"

# ç¿»è¯‘é…ç½®
CATEGORY_MAPPING = {
    "ä¸°èƒ¸": "Tháº©m má»¹ ngá»±c",
    "äº”å®˜": "Tháº©m má»¹ khuÃ´n máº·t",
    "äº§ä¿®": "Phá»¥c há»“i sau sinh",
    "å¸è„‚": "HÃºt má»¡ táº¡o dÃ¡ng",
    "ç‰™çŸ«": "Niá»ng rÄƒng"
}

# é‡è¯•é…ç½®
MAX_RETRIES = 5
RETRY_DELAY = 1  # ç§’

# ç”Ÿæˆé…ç½®
INTERVAL = 15  # åˆ†é’Ÿ
BATCH_SIZE = 100
```

#### è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“é…ç½®

**æ–‡ä»¶**: `scripts/qa_quality_checker.py` (ç¬¬1-30è¡Œ)

```python
# APIé…ç½®
API_URL = "https://ark.cn-beijing.volces.com/api/v3/chat/completions"
API_KEY = "2249d4c5-2e08-4787-9df6-cf5beee474a5"
MODEL = "doubao-seed-1-6-251015"

# æ•°æ®åº“é…ç½®
DATABASE = "/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db"

# æ£€æŸ¥é…ç½®
BATCH_SIZE = 5          # æ¯æ‰¹5æ¡
DELAY = 2.0             # æ‰¹æ¬¡å»¶è¿Ÿ2ç§’
TIMEOUT = 60            # APIè¶…æ—¶60ç§’
TEMPERATURE = 0.3       # é™ä½éšæœºæ€§
```

---

## æ™ºèƒ½ä½“ä¿æŒå¯åŠ¨è§„å®š

### ğŸš€ ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è¦æ±‚

ä¸ºç¡®ä¿åŒ»ç¾çŸ¥è¯†åº“çš„æŒç»­å†…å®¹ç”Ÿæˆï¼Œ**DQAç³»ç»Ÿå’Œç¿»è¯‘æ™ºèƒ½ä½“å¿…é¡»åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¿æŒ24/7è¿è¡Œ**ã€‚

### ğŸ“‹ å¯åŠ¨çŠ¶æ€æ£€æŸ¥æ¸…å•

#### âœ… DQAç³»ç»Ÿå¯åŠ¨æ£€æŸ¥

**æ£€æŸ¥å‘½ä»¤**:
```bash
# 1. æ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical-backend.service

# 2. æ£€æŸ¥DQA APIçŠ¶æ€
curl -s http://localhost:5002/api/dqa/status

# 3. æ£€æŸ¥DQAç”Ÿæˆç»Ÿè®¡
curl -s http://localhost:5002/api/dqa/status | grep -E "(total_generated|success_rate)"
```

**é¢„æœŸç»“æœ**:
- âœ… æœåŠ¡çŠ¶æ€: `active (running)`
- âœ… DQAçŠ¶æ€: `"status": "running"`
- âœ… å®šæ—¶ä»»åŠ¡: `"is_running": true`
- âœ… æˆåŠŸç‡: `"success_rate": "100.00%"`

#### âœ… ç¿»è¯‘æ™ºèƒ½ä½“å¯åŠ¨æ£€æŸ¥

**æ£€æŸ¥å‘½ä»¤**:
```bash
# 1. æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
ps aux | grep qa_translator_agent

# 2. æ£€æŸ¥ç¿»è¯‘è¿›åº¦
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® && python3 scripts/qa_translator_agent.py --stats

# 3. æ£€æŸ¥æ—¥å¿—çŠ¶æ€
tail -20 logs/translator.log | grep -E "(å¯åŠ¨|è¿è¡Œ|ç¿»è¯‘æˆåŠŸ)"
```

**é¢„æœŸç»“æœ**:
- âœ… è¿›ç¨‹å­˜åœ¨: `python3 scripts/qa_translator_agent.py --interval 15`
- âœ… è¿›åº¦å¢é•¿: æ¯15åˆ†é’Ÿ+1æ¡ç¿»è¯‘
- âœ… æ—¥å¿—æ­£å¸¸: æ— ERRORæˆ–APIå¤±è´¥

### ğŸ”§ è‡ªåŠ¨å¯åŠ¨é…ç½®

#### 1. DQAç³»ç»Ÿè‡ªåŠ¨å¯åŠ¨

**é…ç½®æ–¹å¼**: systemdæœåŠ¡è‡ªåŠ¨ç®¡ç†
```bash
# æœåŠ¡é…ç½®
sudo systemctl enable vietnam-medical-backend.service
sudo systemctl start vietnam-medical-backend.service

# éªŒè¯å¼€æœºè‡ªå¯
sudo systemctl is-enabled vietnam-medical-backend.service
# é¢„æœŸè¾“å‡º: enabled
```

**ç‰¹ç‚¹**:
- âœ… å¼€æœºè‡ªåŠ¨å¯åŠ¨
- âœ… å¼‚å¸¸è‡ªåŠ¨é‡å¯
- âœ… æ—¥å¿—è‡ªåŠ¨è®°å½•
- âœ… çŠ¶æ€è‡ªåŠ¨ç›‘æ§

#### 2. ç¿»è¯‘æ™ºèƒ½ä½“è‡ªåŠ¨å¯åŠ¨

**é…ç½®æ–¹å¼**: åå°è¿›ç¨‹ + ç›‘æ§è„šæœ¬
```bash
# å¯åŠ¨è„šæœ¬
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®
nohup python3 scripts/qa_translator_agent.py --interval 15 > logs/translator.log 2>&1 &

# è¿›ç¨‹IDè®°å½•
echo $! > logs/translator.pid

# éªŒè¯å¯åŠ¨
ps aux | grep qa_translator_agent
```

**ç‰¹ç‚¹**:
- âœ… åå°æŒç»­è¿è¡Œ
- âœ… 15åˆ†é’Ÿé—´éš”ç”Ÿæˆ
- âœ… æ—¥å¿—å®Œæ•´è®°å½•
- âœ… è¿›ç¨‹IDè¿½è¸ª

### ğŸ“Š è¿è¡ŒçŠ¶æ€ç›‘æ§

#### æ¯å°æ—¶æ£€æŸ¥

**æ£€æŸ¥è„šæœ¬**:
```bash
#!/bin/bash
# æ™ºèƒ½ä½“çŠ¶æ€æ£€æŸ¥è„šæœ¬

echo "=== æ™ºèƒ½ä½“è¿è¡ŒçŠ¶æ€æ£€æŸ¥ $(date) ==="

# DQAç³»ç»Ÿæ£€æŸ¥
echo "1. DQAç³»ç»ŸçŠ¶æ€:"
systemctl is-active vietnam-medical-backend.service
curl -s http://localhost:5002/api/dqa/status | grep -o '"status":"[^"]*"'

# ç¿»è¯‘æ™ºèƒ½ä½“æ£€æŸ¥
echo "2. ç¿»è¯‘æ™ºèƒ½ä½“çŠ¶æ€:"
if ps aux | grep -q "qa_translator_agent.py --interval 15"; then
    echo "âœ… ç¿»è¯‘æ™ºèƒ½ä½“è¿è¡Œä¸­"
else
    echo "âŒ ç¿»è¯‘æ™ºèƒ½ä½“æœªè¿è¡Œ"
fi

# ç¿»è¯‘è¿›åº¦æ£€æŸ¥
echo "3. ç¿»è¯‘è¿›åº¦:"
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® && python3 scripts/qa_translator_agent.py --stats | grep "è¿›åº¦:"

echo "=== æ£€æŸ¥å®Œæˆ ==="
```

#### æ¯æ—¥ç»Ÿè®¡

**ç»Ÿè®¡å‘½ä»¤**:
```bash
# æ¯æ—¥ç”Ÿæˆç»Ÿè®¡
echo "=== æ¯æ—¥æ™ºèƒ½ä½“ç”Ÿæˆç»Ÿè®¡ $(date) ==="

# DQAç”Ÿæˆç»Ÿè®¡
echo "DQAç³»ç»Ÿ:"
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) as DQA_count FROM knowledge WHERE source='dqa' AND date(created_at) = date('now');"

# ç¿»è¯‘ç”Ÿæˆç»Ÿè®¡
echo "ç¿»è¯‘æ™ºèƒ½ä½“:"
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) as Translation_count FROM knowledge WHERE source='ai_translation' AND date(created_at) = date('now');"

# æ€»ç”Ÿæˆç»Ÿè®¡
echo "æ€»ç”Ÿæˆ:"
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT source, COUNT(*) FROM knowledge WHERE date(created_at) = date('now') GROUP BY source;"
```

### ğŸš¨ å¼‚å¸¸å¤„ç†æµç¨‹

#### 1. DQAç³»ç»Ÿå¼‚å¸¸

**ç—‡çŠ¶**: APIè¿”å›é”™è¯¯æˆ–æœåŠ¡åœæ­¢
```bash
# ç«‹å³å¤„ç†
sudo systemctl restart vietnam-medical-backend.service

# æ£€æŸ¥æ¢å¤
sleep 10
curl -s http://localhost:5002/api/dqa/status

# æŸ¥çœ‹æ—¥å¿—
journalctl -u vietnam-medical-backend.service --since "5 minutes ago"
```

#### 2. ç¿»è¯‘æ™ºèƒ½ä½“å¼‚å¸¸

**ç—‡çŠ¶**: è¿›ç¨‹æ¶ˆå¤±æˆ–APIè°ƒç”¨å¤±è´¥
```bash
# ç«‹å³é‡å¯
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®
kill $(cat logs/translator.pid) 2>/dev/null || true
nohup python3 scripts/qa_translator_agent.py --interval 15 > logs/translator.log 2>&1 &
echo $! > logs/translator.pid

# æ£€æŸ¥æ¢å¤
sleep 5
ps aux | grep qa_translator_agent
```

### ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡è¦æ±‚

#### æœ€ä½è¿è¡Œæ ‡å‡†

| æŒ‡æ ‡ | DQAç³»ç»Ÿ | ç¿»è¯‘æ™ºèƒ½ä½“ | è¦æ±‚ |
|------|---------|----------|------|
| **å¯ç”¨æ€§** | 99.9% | 99.5% | 24/7è¿è¡Œ |
| **ç”Ÿæˆé¢‘ç‡** | æ¯15åˆ†é’Ÿ1æ¡ | æ¯15åˆ†é’Ÿ1æ¡ | ç¨³å®šè¾“å‡º |
| **æˆåŠŸç‡** | â‰¥95% | â‰¥90% | è´¨é‡ä¿è¯ |
| **å“åº”æ—¶é—´** | <5ç§’ | <30ç§’ | æ€§èƒ½è¦æ±‚ |

#### ç›‘æ§å‘Šè­¦

**å‘Šè­¦æ¡ä»¶**:
- âŒ DQAç³»ç»Ÿåœæ­¢è¿è¡Œ
- âŒ ç¿»è¯‘æ™ºèƒ½ä½“è¿›ç¨‹æ¶ˆå¤±
- âŒ è¿ç»­2å°æ—¶æ— æ–°å†…å®¹ç”Ÿæˆ
- âŒ APIæˆåŠŸç‡ä½äº90%

**å‘Šè­¦å¤„ç†**:
1. ç«‹å³é‡å¯ç›¸å…³æœåŠ¡
2. æ£€æŸ¥æ—¥å¿—æ‰¾å‡ºåŸå› 
3. ä¿®å¤æ ¹æœ¬é—®é¢˜
4. éªŒè¯æ¢å¤çŠ¶æ€

### ğŸ”„ ç»´æŠ¤è®¡åˆ’

#### æ¯æ—¥ç»´æŠ¤ (5åˆ†é’Ÿ)

```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical-backend.service
ps aux | grep qa_translator_agent

# 2. æ£€æŸ¥ç”Ÿæˆç»Ÿè®¡
curl -s http://localhost:5002/api/dqa/status | grep total_generated
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® && python3 scripts/qa_translator_agent.py --stats

# 3. æ£€æŸ¥æ—¥å¿—é”™è¯¯
tail -100 logs/translator.log | grep ERROR
journalctl -u vietnam-medical-backend.service --since "1 day ago" | grep ERROR
```

#### æ¯å‘¨ç»´æŠ¤ (30åˆ†é’Ÿ)

```bash
# 1. æ•°æ®åº“å¤‡ä»½
cp /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
   /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backup/database_$(date +%Y%m%d).sqlite

# 2. æ—¥å¿—æ¸…ç†
find /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/logs -name "*.log" -mtime +7 -exec gzip {} \;
find /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/logs -name "*.log.gz" -mtime +30 -delete

# 3. æ€§èƒ½æ£€æŸ¥
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite "VACUUM;"
```

#### æ¯æœˆç»´æŠ¤ (2å°æ—¶)

```bash
# 1. ç³»ç»Ÿæ›´æ–°
sudo apt update && sudo apt upgrade -y

# 2. ä¾èµ–æ›´æ–°
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend && npm update
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® && pip3 install --upgrade requests

# 3. å…¨é¢æ£€æŸ¥
./scripts/smart_agent_monitor.sh --full-check
```

### ğŸ“‹ å¯åŠ¨æ£€æŸ¥æ¸…å•

#### éƒ¨ç½²åå¿…é¡»éªŒè¯

- [ ] DQAç³»ç»ŸAPIå“åº”æ­£å¸¸
- [ ] ç¿»è¯‘æ™ºèƒ½ä½“è¿›ç¨‹è¿è¡Œä¸­
- [ ] ä¸¤ä¸ªæ™ºèƒ½ä½“éƒ½èƒ½ç”Ÿæˆå†…å®¹
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸æ— é”™è¯¯
- [ ] æ•°æ®åº“å†™å…¥æ­£å¸¸
- [ ] å‰ç«¯é¡µé¢èƒ½æ˜¾ç¤ºæ–°å†…å®¹

#### è¿è¡Œä¸­å¿…é¡»ç›‘æ§

- [ ] æ¯å°æ—¶æ£€æŸ¥æœåŠ¡çŠ¶æ€
- [ ] æ¯æ—¥æ£€æŸ¥ç”Ÿæˆç»Ÿè®¡
- [ ] æ¯å‘¨æ£€æŸ¥æ—¥å¿—é”™è¯¯
- [ ] æ¯æœˆæ£€æŸ¥æ€§èƒ½æŒ‡æ ‡

### âš ï¸ é‡è¦æé†’

1. **ç¦æ­¢åœæ­¢**: ç”Ÿäº§ç¯å¢ƒä¸­ä¸¥ç¦æ‰‹åŠ¨åœæ­¢DQAç³»ç»Ÿæˆ–ç¿»è¯‘æ™ºèƒ½ä½“
2. **åŠæ—¶å¤„ç†**: å‘ç°å¼‚å¸¸å¿…é¡»ç«‹å³å¤„ç†ï¼Œä¸å¾—æ‹–å»¶
3. **å¤‡ä»½ä¼˜å…ˆ**: ä»»ä½•ç»´æŠ¤æ“ä½œå‰å¿…é¡»å…ˆå¤‡ä»½æ•°æ®åº“
4. **æ—¥å¿—è®°å½•**: æ‰€æœ‰æ“ä½œéƒ½è¦è®°å½•åœ¨æ—¥å¿—ä¸­
5. **æµ‹è¯•éªŒè¯**: é‡å¯åå¿…é¡»éªŒè¯åŠŸèƒ½æ­£å¸¸

---

## ç®¡ç†å‘½ä»¤

### DQAç³»ç»Ÿç®¡ç†

```bash
# æŸ¥çœ‹ç”Ÿæˆç»Ÿè®¡
curl http://localhost:5002/api/dqa/stats

# æŸ¥çœ‹æ•°æ®åº“ä¸­DQAç”Ÿæˆçš„æ•°æ®
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM knowledge WHERE source='dqa';"

# åˆ†ç±»ç»Ÿè®¡
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT category, COUNT(*) FROM knowledge WHERE source='dqa' GROUP BY category;"

# æœ€è¿‘ç”Ÿæˆçš„é—®ç­”
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT * FROM knowledge WHERE source='dqa' ORDER BY created_at DESC LIMIT 5;"

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep node

# æŸ¥çœ‹æ—¥å¿—
tail -f /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/logs/app.log
```

### ç¿»è¯‘æ™ºèƒ½ä½“ç®¡ç†

```bash
# æŸ¥çœ‹ç¿»è¯‘è¿›åº¦
python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py --stats

# æŸ¥çœ‹åˆ†ç±»åˆ†å¸ƒ
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT category, COUNT(*) FROM knowledge WHERE source='ai_translation' GROUP BY category ORDER BY COUNT(*) DESC;"

# å•æ¬¡æ‰‹åŠ¨ç¿»è¯‘
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py --once'

# æ‰¹é‡ç¿»è¯‘100æ¡
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
nohup python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py --batch 100 > logs/batch.log 2>&1 &'

# é‡ç½®ç¿»è¯‘è¿›åº¦
python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py --reset

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep qa_translator_agent

# æŸ¥çœ‹æ—¥å¿—
tail -f /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/logs/qa_translator_background.log

# åœæ­¢æœåŠ¡
kill <PID>
```

### è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“ç®¡ç†

```bash
# å¿«é€Ÿæ£€æŸ¥æ‰€æœ‰é—®ç­”
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®
./scripts/quick_qa_check.sh

# æ£€æŸ¥ç‰¹å®šåˆ†ç±»
python3 scripts/qa_quality_checker.py --category ä¸°èƒ¸

# å®‰å…¨æ¨¡å¼ï¼ˆé™ä½APIè°ƒç”¨é¢‘ç‡ï¼‰
python3 scripts/qa_quality_checker.py --batch-size 3 --delay 3.0

# æŸ¥çœ‹ä¿®æ”¹å†å²
sqlite3 backend/data/medical.db \
  "SELECT * FROM knowledge_history ORDER BY modified_at DESC LIMIT 10;"

# æŸ¥çœ‹ç‰¹å®šè®°å½•çš„ä¿®æ”¹å†å²
sqlite3 backend/data/medical.db \
  "SELECT * FROM knowledge_history WHERE knowledge_id = 15;"

# æŸ¥çœ‹è´¨é‡æŠ¥å‘Š
ls logs/qa_quality_report_*.json

# æŸ¥çœ‹è¿›ç¨‹æ—¥å¿—
tail -f logs/qa_checker.log
```

---

## æ•…éšœæ’é™¤

### DQAç³»ç»Ÿé—®é¢˜

#### é—®é¢˜1: åŒ»é™¢æ•°æ®ä¸å®Œæ•´

**ç—‡çŠ¶**: ç”Ÿæˆé—®ç­”å†…å®¹ä¸å®Œæ•´

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ•°æ®æº
curl http://localhost:5002/api/hospitals/count

# è¡¥å……æ•°æ®
npm run import-hospitals
```

#### é—®é¢˜2: æ‹ŸäººåŒ–ä¸ç”Ÿæ•ˆ

**ç—‡çŠ¶**: ç”Ÿæˆé—®ç­”è¿‡äºæœºæ¢°

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// backend/config/dqa.config.js
{
  humanization: {
    enableGreetings: true,
    enableClosings: true,
    enableTransitions: true,
    temperature: 0.8  // å¢åŠ åˆ›æ„ç¨‹åº¦
  }
}
```

### ç¿»è¯‘æ™ºèƒ½ä½“é—®é¢˜

#### é—®é¢˜1: ç¿»è¯‘ä¸­æ–‡æ®‹ç•™

**ç—‡çŠ¶**: ç¿»è¯‘ç»“æœä¸­åŒ…å«ä¸­æ–‡

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…ç†å·²æœ‰çš„é”™è¯¯è®°å½•
python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/clean_chinese_records.py

# é‡ç½®è¿›åº¦é‡æ–°å¼€å§‹
python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py --reset
```

#### é—®é¢˜2: ç¿»è¯‘éƒ½åœ¨ä¸€ä¸ªåˆ†ç±»

**ç—‡çŠ¶**: æ‰€æœ‰ç¿»è¯‘éƒ½é›†ä¸­åœ¨æŸä¸ªåˆ†ç±»

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥å‡åŒ€åˆ†å¸ƒé€»è¾‘
tail -100 logs/qa_translator_background.log | grep "ğŸ“Š åˆ†ç±»åˆ†å¸ƒç»Ÿè®¡"

# é‡ç½®è¿›åº¦é‡æ–°å¼€å§‹
python3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/scripts/qa_translator_agent.py --reset

# é‡æ–°å¯åŠ¨
nohup python3 scripts/qa_translator_agent.py --batch 100 > logs/batch.log 2>&1 &
```

#### é—®é¢˜3: APIè°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**: JSONè§£æå¤±è´¥æˆ–APIè¿”å›ç©º

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ä»£ç†è®¾ç½®
env | grep -i proxy

# æ¸…é™¤ä»£ç†
unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY

# æµ‹è¯•APIè¿æ¥
python3 scripts/test_doubao_api.py

# é‡æ–°å¯åŠ¨
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
nohup python3 scripts/qa_translator_agent.py --interval 15 > logs/qa_translator.log 2>&1 &'
```

#### é—®é¢˜4: è¿›ç¨‹å·²åœæ­¢

**ç—‡çŠ¶**: ç¿»è¯‘ä¸å†è¿›è¡Œ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥è¿›ç¨‹
ps aux | grep qa_translator_agent

# æŸ¥çœ‹æ—¥å¿—æ‰¾åŸå› 
tail -100 logs/qa_translator_background.log

# é‡æ–°å¯åŠ¨
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
nohup python3 scripts/qa_translator_agent.py --interval 15 > logs/qa_translator.log 2>&1 &'
```

### è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“é—®é¢˜

#### é—®é¢˜1: APIè°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**: ç½‘ç»œè¿æ¥è¶…æ—¶æˆ–è¿”å›é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æµ‹è¯•APIè¿æ¥
python3 scripts/test_doubao_api.py

# æ£€æŸ¥ä»£ç†è®¾ç½®
env | grep -i proxy

# æ¸…é™¤ä»£ç†
unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY
```

#### é—®é¢˜2: æ•°æ®åº“é”å®š

**ç—‡çŠ¶**: `database is locked` é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥å ç”¨è¿›ç¨‹
lsof /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db

# ç¡®ä¿æ²¡æœ‰å…¶ä»–è¿›ç¨‹åœ¨ä½¿ç”¨
ps aux | grep qa_quality_checker
ps aux | grep qa_translator_agent
```

#### é—®é¢˜3: ä¿®æ­£æ•ˆæœä¸ç†æƒ³

**ç—‡çŠ¶**: è‡ªåŠ¨ä¿®æ­£çš„å†…å®¹è´¨é‡å·®

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥çœ‹ä¿®æ”¹å†å²ï¼Œæ£€æŸ¥ä¿®æ­£å†…å®¹
sqlite3 backend/data/medical.db \
  "SELECT knowledge_id, issues FROM knowledge_history ORDER BY modified_at DESC LIMIT 5;"

# è°ƒæ•´æ£€æŸ¥å‚æ•°ï¼Œé™ä½è‡ªåŠ¨ä¿®æ­£æ•æ„Ÿæ€§
# ç¼–è¾‘ scripts/qa_quality_checker.py ä¸­çš„æ£€æŸ¥é˜ˆå€¼
```

---

## ç›‘æ§ä¸ç»´æŠ¤

### æ—¥å¸¸ç›‘æ§

**æ¯å°æ—¶æ£€æŸ¥**:
```bash
# DQAç³»ç»Ÿ
curl http://localhost:5002/api/dqa/stats | grep "count"

# ç¿»è¯‘æ™ºèƒ½ä½“
ps aux | grep qa_translator_agent
```

**æ¯å¤©æ£€æŸ¥**:
```bash
# æ•°æ®åº“å¢é•¿
sqlite3 backend/data/database.sqlite \
  "SELECT source, COUNT(*) FROM knowledge GROUP BY source;"

# åˆ†ç±»åˆ†å¸ƒ
sqlite3 backend/data/database.sqlite \
  "SELECT category, COUNT(*) FROM knowledge GROUP BY category;"
```

**æ¯å‘¨ç»´æŠ¤**:
```bash
# å¤‡ä»½æ•°æ®åº“
cp backend/data/database.sqlite backup/database_$(date +%Y%m%d).sqlite

# æŸ¥çœ‹æ—¥å¿—
tail -1000 logs/qa_translator_background.log | grep ERROR

# æ¸…ç†æ—§æ—¥å¿—
find logs -name "*.log" -mtime +30 -delete
```

### æ€§èƒ½ä¼˜åŒ–

**DQAç³»ç»Ÿä¼˜åŒ–**:
- å¢åŠ æ‰¹å¤„ç†å¤§å° â†’ æå‡ååé‡
- è°ƒæ•´temperatureå‚æ•° â†’ å¹³è¡¡è´¨é‡å’Œå¤šæ ·æ€§
- ç¼“å­˜åŒ»é™¢æ•°æ® â†’ å‡å°‘æ•°æ®åº“æŸ¥è¯¢

**ç¿»è¯‘æ™ºèƒ½ä½“ä¼˜åŒ–**:
- è°ƒæ•´MAX_TOKENS â†’ å¹³è¡¡æˆæœ¬å’Œè´¨é‡
- ä¿®æ”¹BATCH_SIZE â†’ ä¼˜åŒ–å†…å­˜ä½¿ç”¨
- ä¼˜åŒ–å‡åŒ€åˆ†å¸ƒç®—æ³• â†’ æ›´å¿«è¦†ç›–

---

## å¿«é€Ÿå‚è€ƒ

### å¯åŠ¨å‘½ä»¤

```bash
# DQAç³»ç»Ÿï¼ˆè‡ªåŠ¨å¯åŠ¨ï¼‰
npm start

# ç¿»è¯‘æ™ºèƒ½ä½“ï¼ˆæ¯15åˆ†é’Ÿ1æ¡ï¼‰
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
nohup python3 scripts/qa_translator_agent.py --interval 15 > logs/qa_translator.log 2>&1 &'

# ç¿»è¯‘æ™ºèƒ½ä½“ï¼ˆæ‰¹é‡100æ¡ï¼‰
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
nohup python3 scripts/qa_translator_agent.py --batch 100 > logs/batch.log 2>&1 &'
```

### æŸ¥è¯¢å‘½ä»¤

```bash
# æ€»æ•°æ®ç»Ÿè®¡
sqlite3 backend/data/database.sqlite "SELECT source, COUNT(*) FROM knowledge GROUP BY source;"

# DQAç»Ÿè®¡
sqlite3 backend/data/database.sqlite "SELECT COUNT(*) FROM knowledge WHERE source='dqa';"

# ç¿»è¯‘ç»Ÿè®¡
sqlite3 backend/data/database.sqlite "SELECT COUNT(*) FROM knowledge WHERE source='ai_translation';"

# åˆ†ç±»åˆ†å¸ƒ
sqlite3 backend/data/database.sqlite "SELECT category, COUNT(*) FROM knowledge GROUP BY category;"
```

### æ—¥å¿—æŸ¥çœ‹

```bash
# DQAæ—¥å¿—
tail -f backend/logs/app.log

# ç¿»è¯‘æ—¥å¿—
tail -f logs/qa_translator_background.log

# ç¿»è¯‘è¿›åº¦
python3 scripts/qa_translator_agent.py --stats
```

---

## æ€»ç»“

è¯¥é¡¹ç›®éƒ¨ç½²äº†ä¸‰ä¸ªååŒå·¥ä½œçš„æ™ºèƒ½ä½“ç³»ç»Ÿ:

âœ… **DQAç³»ç»Ÿ v1.5.0**
- åŸºäº122å®¶åŒ»é™¢æ•°æ®
- æ¯æ—¥96æ¡é—®ç­”
- é«˜åº¦æ‹ŸäººåŒ–è¡¨è¾¾

âœ… **ç¿»è¯‘æ™ºèƒ½ä½“ v3.0**
- 1,829æ¡ä¸­æ–‡é—®ç­”
- 5å¤§ç±»å‡åŒ€åˆ†å¸ƒ
- 100%çº¯è¶Šå—è¯­

âœ… **è´¨é‡æ£€æŸ¥æ™ºèƒ½ä½“ v1.0**
- è‡ªåŠ¨æ£€æŸ¥å’Œä¿®æ­£
- å¤šç»´åº¦è´¨é‡è¯„ä¼°
- å†å²è®°å½•å®Œæ•´è¿½è¸ª

**æ€»äº§èƒ½**: 
- ç”Ÿæˆ: 192æ¡/å¤©ã€5,760æ¡/æœˆ
- è´¨é‡: æŒç»­æ”¹è¿›å’Œä¼˜åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: v5.0 ç”Ÿäº§è¿è¡Œç‰ˆ  
**æœ€åæ›´æ–°**: 2025-10-26 16:45  
**ç»´æŠ¤äººå‘˜**: å¼€å‘å›¢é˜Ÿ  
**çŠ¶æ€**: âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­

