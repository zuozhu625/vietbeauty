# è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¸è¿ç»´æŒ‡å— v2.0

**ç‰ˆæœ¬**: v2.0 (æ•°æ®åº“åˆ†ç¦»ä¼˜åŒ–ç‰ˆ)  
**æœ€åæ›´æ–°**: 2025-10-26 15:50  
**çŠ¶æ€**: âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
3. [å¿«é€Ÿéƒ¨ç½²](#å¿«é€Ÿéƒ¨ç½²)
4. [æœåŠ¡ç®¡ç†](#æœåŠ¡ç®¡ç†)
5. [æ•°æ®åº“ç®¡ç†](#æ•°æ®åº“ç®¡ç†)
6. [æ™ºèƒ½ä½“ç³»ç»Ÿ](#æ™ºèƒ½ä½“ç³»ç»Ÿ)
7. [ç›‘æ§ä¸ç»´æŠ¤](#ç›‘æ§ä¸ç»´æŠ¤)
8. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## é¡¹ç›®æ¦‚è¿°

### åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | ä¿¡æ¯ |
|------|------|
| **é¡¹ç›®åç§°** | è¶Šå—åŒ»ç–—æ•´å½¢å¹³å° |
| **å®˜æ–¹åŸŸå** | https://vietbeauty.top â­ |
| **å¤‡ç”¨åŸŸå** | https://www.vietbeauty.top |
| **IPè®¿é—®** | http://47.237.79.9:5001 |
| **å‰ç«¯æ¡†æ¶** | Astro v5.14.1 (SSRæ¨¡å¼) |
| **åç«¯æ¡†æ¶** | Node.js + Express |
| **æ•°æ®åº“** | SQLite3 (åŒåº“åˆ†ç¦») |
| **SSLè¯ä¹¦** | Let's Encrypt (è‡ªåŠ¨ç»­æœŸ) |
| **éƒ¨ç½²çŠ¶æ€** | âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­ |

### âš ï¸ æ ¸å¿ƒæ¦‚å¿µï¼šåŒæ•°æ®åº“åˆ†ç¦»

**æœ¬é¡¹ç›®é‡‡ç”¨åŒæ•°æ®åº“åˆ†ç¦»æ¶æ„ï¼Œéå¸¸é‡è¦ï¼**

| æ•°æ®åº“ | è·¯å¾„ | ç”¨é€” | è¯­è¨€ | å¤‡æ³¨ |
|--------|------|------|------|------|
| **database.sqlite** | `/backend/data/database.sqlite` | å‰ç«¯ç½‘ç«™å±•ç¤º | è¶Šå—è¯­ | âœ… ç”¨æˆ·å¯è§ |
| **medical.db** | `/backend/data/medical.db` | æ™ºèƒ½ä½“è®­ç»ƒ | ä¸­æ–‡ | âš™ï¸ å†…éƒ¨ä½¿ç”¨ |

---

## ç³»ç»Ÿæ¶æ„

### å®Œæ•´æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”¨æˆ·è®¿é—® (https://vietbeauty.top)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginxåå‘ä»£ç† (Port 80/443)                        â”‚
â”‚  â€¢ SSL/TLSåŠ å¯† (Let's Encrypt)                      â”‚
â”‚  â€¢ Gzipå‹ç¼©                                          â”‚
â”‚  â€¢ HTTP â†’ HTTPSè‡ªåŠ¨é‡å®šå‘                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â†“         â†“             â†“             â†“
å‰ç«¯SSR    åç«¯API      åŒ»é™¢é—®ç­”    ç”¨æˆ·åˆ†äº«
Port:5001  Port:5002    DQAæœåŠ¡     N8Næ¥å£
    â†“         â†“             â†“             â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  database.sqlite        â”‚
    â”‚  (è¶Šå—è¯­ç½‘ç«™æ•°æ®)        â”‚
    â”‚ â€¢ 122å®¶åŒ»é™¢              â”‚
    â”‚ â€¢ 367æ¡ç”¨æˆ·åˆ†äº«          â”‚
    â”‚ â€¢ DQAç”Ÿæˆçš„é—®ç­”         â”‚
    â”‚ â€¢ æœåŠ¡/è”ç³»ä¿¡æ¯         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ç‹¬ç«‹å­˜å‚¨ï¼šmedical.db (ä¸­æ–‡æ™ºèƒ½ä½“æ•°æ®)
    â€¢ 1,829æ¡ä¸­æ–‡é—®ç­” (è®­ç»ƒç”¨ï¼Œä¸å¯¹å¤–)
    â€¢ è´¨é‡æ£€æŸ¥å†å²è®°å½•
```

### æ•°æ®æµå‘è¯´æ˜

**åŒ»é™¢æ•°æ®**:
```
æ‰‹å·¥åˆ›å»º â†’ database.sqlite â†’ åç«¯API â†’ å‰ç«¯å±•ç¤º
```

**ç”¨æˆ·åˆ†äº«**:
```
N8Nå·¥ä½œæµ â†’ APIæ¥å£ â†’ database.sqlite â†’ å‰ç«¯å±•ç¤º
```

**çŸ¥è¯†é—®ç­”ï¼ˆå‰ç«¯å±•ç¤ºï¼‰**:
```
DQAç³»ç»Ÿ (è‡ªåŠ¨) â†’ æ¯15åˆ†é’Ÿ1æ¡ â†’ database.sqlite â†’ å‰ç«¯å±•ç¤º (è¶Šå—è¯­)
```

**çŸ¥è¯†é—®ç­”ï¼ˆæ™ºèƒ½ä½“è®­ç»ƒï¼‰**:
```
Excelå¯¼å…¥ â†’ medical.db â†’ æ™ºèƒ½ä½“å¤„ç† â†’ medical.db (ä¸­æ–‡ï¼Œä¸å¯¹å¤–)
```

---

## å¿«é€Ÿéƒ¨ç½²

### ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®
./deploy.sh
```

**éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œ**:
- âœ… åœæ­¢ç°æœ‰æœåŠ¡
- âœ… å®‰è£…ä¾èµ–åŒ…ï¼ˆnpm installï¼‰
- âœ… åˆå§‹åŒ–æ•°æ®åº“ï¼ˆè‹¥éœ€è¦ï¼‰
- âœ… é…ç½®systemdæœåŠ¡
- âœ… å¯åŠ¨æ‰€æœ‰æœåŠ¡
- âœ… å¥åº·æ£€æŸ¥
- âœ… æ˜¾ç¤ºè®¿é—®ä¿¡æ¯

### éƒ¨ç½²æ£€æŸ¥æ¸…å•

#### éƒ¨ç½²å‰
- [ ] Node.js å·²å®‰è£… (`node --version`)
- [ ] npm å·²å®‰è£… (`npm --version`)
- [ ] ç«¯å£ 80, 443, 5001, 5002 æœªè¢«å ç”¨
- [ ] æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ (æœ€å°‘5GB)
- [ ] ç½‘ç»œè¿æ¥ç¨³å®š

#### éƒ¨ç½²å
- [ ] å‰ç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ (https://vietbeauty.top)
- [ ] åç«¯APIæ­£å¸¸è¿è¡Œ (curl http://localhost:5002/health)
- [ ] DQAæœåŠ¡æ­£å¸¸è¿è¡Œ (curl http://localhost:5002/api/dqa/status)
- [ ] SSLè¯ä¹¦æœ‰æ•ˆ (https://vietbeauty.top)
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] æ‰€æœ‰é¡µé¢å¯è®¿é—®

---

## æœåŠ¡ç®¡ç†

### å‰ç«¯æœåŠ¡ (SSR)

**æœåŠ¡åç§°**: `vietnam-medical.service`  
**è¿è¡Œå‘½ä»¤**: `node ./dist/server/entry.mjs`  
**ç«¯å£**: 5001  
**å·¥ä½œç›®å½•**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®`

```bash
# å¯åŠ¨å‰ç«¯æœåŠ¡
systemctl start vietnam-medical.service

# åœæ­¢å‰ç«¯æœåŠ¡
systemctl stop vietnam-medical.service

# é‡å¯å‰ç«¯æœåŠ¡
systemctl restart vietnam-medical.service

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical.service

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
journalctl -u vietnam-medical.service -f

# æŸ¥çœ‹æœ€è¿‘50è¡Œæ—¥å¿—
journalctl -u vietnam-medical.service -n 50
```

### åç«¯æœåŠ¡ (API)

**æœåŠ¡åç§°**: `vietnam-medical-backend.service`  
**è¿è¡Œå‘½ä»¤**: `node src/server.js`  
**ç«¯å£**: 5002  
**å·¥ä½œç›®å½•**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend`

```bash
# å¯åŠ¨åç«¯æœåŠ¡
systemctl start vietnam-medical-backend.service

# åœæ­¢åç«¯æœåŠ¡
systemctl stop vietnam-medical-backend.service

# é‡å¯åç«¯æœåŠ¡
systemctl restart vietnam-medical-backend.service

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical-backend.service

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
journalctl -u vietnam-medical-backend.service -f

# æŸ¥çœ‹æœ€è¿‘50è¡Œæ—¥å¿—
journalctl -u vietnam-medical-backend.service -n 50
```

### NginxæœåŠ¡ (åå‘ä»£ç†)

**æœåŠ¡åç§°**: `nginx.service`  
**é…ç½®æ–‡ä»¶**: `/etc/nginx/conf.d/vietbeauty.conf`  
**ç«¯å£**: 80 (HTTP), 443 (HTTPS)

```bash
# å¯åŠ¨Nginx
systemctl start nginx.service

# åœæ­¢Nginx
systemctl stop nginx.service

# é‡å¯Nginx
systemctl restart nginx.service

# é‡è½½é…ç½®ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰
systemctl reload nginx.service

# æµ‹è¯•é…ç½®æ–‡ä»¶
nginx -t

# æŸ¥çœ‹NginxçŠ¶æ€
systemctl status nginx.service

# æŸ¥çœ‹å®æ—¶è®¿é—®æ—¥å¿—
tail -f /var/log/nginx/vietbeauty_access.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/vietbeauty_error.log
```

### æ‰¹é‡æ“ä½œ

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical.service vietnam-medical-backend.service nginx.service

# é‡å¯æ‰€æœ‰æœåŠ¡
systemctl restart vietnam-medical.service vietnam-medical-backend.service nginx.service

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
journalctl -u vietnam-medical.service -u vietnam-medical-backend.service -f

# åœæ­¢æ‰€æœ‰æœåŠ¡
systemctl stop vietnam-medical.service vietnam-medical-backend.service nginx.service

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
systemctl start vietnam-medical.service vietnam-medical-backend.service nginx.service
```

---

## æ•°æ®åº“ç®¡ç†

### åŒæ•°æ®åº“æ¶æ„è¯´æ˜

#### 1. database.sqlite (å‰ç«¯æ•°æ®åº“)

**è·¯å¾„**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite`

**åŒ…å«çš„è¡¨**:

| è¡¨å | æ•°æ®é‡ | è¯´æ˜ | çŠ¶æ€ |
|------|--------|------|------|
| `hospitals` | 122æ¡ | è¶Šå—åŒ»é™¢ä¿¡æ¯ | âœ… ç¨³å®š |
| `user_shares` | 367æ¡ | ç”¨æˆ·åˆ†äº«ï¼ˆè¶Šå—è¯­ï¼‰ | âœ… N8NæŒç»­å¢é•¿ |
| `knowledge` | åŠ¨æ€å¢é•¿ | çŸ¥è¯†é—®ç­”ï¼ˆDQAè‡ªåŠ¨ç”Ÿæˆï¼‰ | âœ… è‡ªåŠ¨åŒ– |
| `services` | 2æ¡ | æœåŠ¡é¡¹ç›® | âœ… æœ‰æ•°æ® |
| `contacts` | 1æ¡ | è”ç³»ä¿¡æ¯ | âœ… æœ‰æ•°æ® |

**ä½¿ç”¨åœºæ™¯**:
- å‰ç«¯ç½‘ç«™å±•ç¤º
- ç”¨æˆ·å¯è§çš„æ‰€æœ‰æ•°æ®æ¥æº
- æ‰€æœ‰æ•°æ®ä¸ºè¶Šå—è¯­

```bash
# æŸ¥è¯¢åŒ»é™¢æ€»æ•°
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM hospitals;"

# æŸ¥è¯¢ç”¨æˆ·åˆ†äº«æ€»æ•°
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM user_shares;"

# æŸ¥è¯¢DQAç”Ÿæˆçš„é—®ç­”æ•°
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM knowledge WHERE source='dqa';"
```

#### 2. medical.db (æ™ºèƒ½ä½“æ•°æ®åº“)

**è·¯å¾„**: `/root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db`

**åŒ…å«çš„è¡¨**:

| è¡¨å | æ•°æ®é‡ | è¯´æ˜ |
|------|--------|------|
| `knowledge` | 1,829æ¡ | ä¸­æ–‡åŒ»ç¾é—®ç­”ï¼ˆè®­ç»ƒç”¨ï¼‰ |
| `knowledge_history` | å†å²è®°å½• | æ™ºèƒ½ä½“ä¿®æ”¹è®°å½• |
| `hospitals` | 122æ¡ | åŒ»é™¢å¤‡ä»½ |
| `user_shares` | 367æ¡ | åˆ†äº«å¤‡ä»½ |

**ä½¿ç”¨åœºæ™¯**:
- æ™ºèƒ½ä½“è´¨é‡æ£€æŸ¥
- æ™ºèƒ½ä½“æ‹ŸäººåŒ–ç¿»è¯‘
- å†…éƒ¨ä½¿ç”¨ï¼Œä¸å¯¹å¤–å±•ç¤º
- æ‰€æœ‰æ•°æ®ä¸ºä¸­æ–‡

**ä¸­æ–‡é—®ç­”åˆ†ç±»ç»Ÿè®¡**:

| åˆ†ç±» | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| ä¸°èƒ¸ | 381æ¡ | éš†èƒ¸ç›¸å…³ |
| äº”å®˜ | 500æ¡ | é¢éƒ¨æ•´å½¢ |
| äº§ä¿® | 201æ¡ | äº§åä¿®å¤ |
| å¸è„‚ | 298æ¡ | å¸è„‚å¡‘å½¢ |
| ç‰™çŸ« | 449æ¡ | ç‰™é½¿çŸ«æ­£ |
| **æ€»è®¡** | **1,829æ¡** | **å®Œæ•´æ•°æ®é›†** |

### æ•°æ®åº“ç»´æŠ¤

```bash
# æŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶å¤§å°
du -h /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/*.sqlite
du -h /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db

# å¤‡ä»½å‰ç«¯æ•°æ®åº“
cp /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
   /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database_backup_$(date +%Y%m%d_%H%M%S).sqlite

# å¤‡ä»½æ™ºèƒ½ä½“æ•°æ®åº“
cp /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db \
   /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical_backup_$(date +%Y%m%d_%H%M%S).db

# ä¼˜åŒ–æ•°æ®åº“ï¼ˆæ¸…ç†ç¢ç‰‡ï¼‰
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite "VACUUM;"
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/medical.db "VACUUM;"

# å¯¼å‡ºæ•°æ®ä¸ºSQL
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite ".dump" > database_export.sql

# æ¢å¤æ•°æ®åº“
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite < database_export.sql
```

### âš ï¸ ç¦æ­¢æ“ä½œ

```bash
# âŒ ä¸è¦æ··æ·†æ•°æ®åº“è·¯å¾„
# âŒ ä¸è¦å°†medical.dbçš„ä¸­æ–‡æ•°æ®å¯¼å…¥database.sqlite
# âŒ ä¸è¦åœ¨å‰ç«¯å±•ç¤ºmedical.dbçš„å†…å®¹
# âŒ ä¸è¦åˆ é™¤ä»»ä½•ç”Ÿäº§æ•°æ®åº“
# âŒ ä¸è¦éšæ„ä¿®æ”¹æ•°æ®åº“è¡¨ç»“æ„
```

---

## æ™ºèƒ½ä½“ç³»ç»Ÿ

### DQAè‡ªåŠ¨é—®ç­”ç³»ç»Ÿ

**åŠŸèƒ½**: è‡ªåŠ¨ç”Ÿæˆè¶Šå—è¯­åŒ»é™¢é—®ç­”

**é…ç½®**:

| é¡¹ç›® | å€¼ |
|------|-----|
| **æ•°æ®æº** | 122å®¶åŒ»é™¢æ•°æ® |
| **ç”Ÿæˆé¢‘ç‡** | æ¯15åˆ†é’Ÿ1æ¡ |
| **æ¯æ—¥äº§é‡** | 96æ¡ |
| **æ¯æœˆäº§é‡** | ~2,880æ¡ |
| **é—®ç­”ç±»å‹** | 6ç§ï¼ˆèµ„è´¨ã€ç­‰çº§ã€æœåŠ¡ã€åœ°å€ã€è”ç³»ã€åŒ»ç”Ÿï¼‰ |
| **è¯­è¨€** | è¶Šå—è¯­ |
| **ç›®æ ‡æ•°æ®åº“** | database.sqlite |

**ç›‘æ§DQA**:

```bash
# æŸ¥çœ‹DQAæœåŠ¡çŠ¶æ€
curl http://localhost:5002/api/dqa/status

# æŸ¥çœ‹DQAç»Ÿè®¡ä¿¡æ¯
curl http://localhost:5002/api/dqa/stats

# æŸ¥çœ‹ç”Ÿæˆçš„é—®ç­”æ•°
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM knowledge WHERE source='dqa';"

# æŒ‰åˆ†ç±»æŸ¥çœ‹é—®ç­”åˆ†å¸ƒ
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT category, COUNT(*) FROM knowledge WHERE source='dqa' GROUP BY category;"
```

### è¶Šå—è¯­ç¿»è¯‘æ™ºèƒ½ä½“

**åŠŸèƒ½**: ç¿»è¯‘ä¸­æ–‡é—®ç­”ä¸ºè¶Šå—è¯­ï¼ˆå‡åŒ€åˆ†å¸ƒï¼‰

**é…ç½®**:

| é¡¹ç›® | å€¼ |
|------|-----|
| **æ•°æ®æº** | medical.db (1,829æ¡ä¸­æ–‡é—®ç­”) |
| **ç”Ÿæˆæ¨¡å¼** | æ‰¹é‡æˆ–å®šæ—¶ |
| **åˆ†ç±»åˆ†å¸ƒ** | 5å¤§åˆ†ç±»å‡åŒ€åˆ†å¸ƒ |
| **è´¨é‡æ£€æŸ¥** | 100%çº¯è¶Šå—è¯­ + è‡ªåŠ¨æ¸…ç†ä¸­æ–‡ |
| **ç›®æ ‡æ•°æ®åº“** | database.sqlite |

**å¯åŠ¨ç¿»è¯‘æ™ºèƒ½ä½“**:

```bash
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®

# å•æ¡ç¿»è¯‘æµ‹è¯•
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
python3 scripts/qa_translator_agent.py --once'

# æ‰¹é‡ç¿»è¯‘100æ¡
bash -c 'unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY; \
nohup python3 scripts/qa_translator_agent.py --batch 100 > logs/batch_100.log 2>&1 &'

# æŸ¥çœ‹ç¿»è¯‘è¿›åº¦
python3 scripts/qa_translator_agent.py --stats

# æŸ¥çœ‹åˆ†ç±»åˆ†å¸ƒ
sqlite3 backend/data/database.sqlite \
  "SELECT category, COUNT(*) FROM knowledge WHERE source='ai_translation' GROUP BY category;"
```

---

## ç›‘æ§ä¸ç»´æŠ¤

### æ—¥å¸¸ç›‘æ§

**æ¯å°æ—¶æ£€æŸ¥**:

```bash
# æ£€æŸ¥å‰ç«¯æœåŠ¡
curl -I https://vietbeauty.top

# æ£€æŸ¥åç«¯API
curl http://localhost:5002/health

# æ£€æŸ¥DQAæœåŠ¡
curl http://localhost:5002/api/dqa/status
```

**æ¯å¤©æ£€æŸ¥**:

```bash
# æ•°æ®åº“å¢é•¿æƒ…å†µ
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT source, COUNT(*) FROM knowledge GROUP BY source;"

# æ£€æŸ¥æœåŠ¡è¿è¡Œæ—¶é—´
systemctl status vietnam-medical.service vietnam-medical-backend.service nginx.service

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h | grep -E '/$|/root'
```

**æ¯å‘¨æ£€æŸ¥**:

```bash
# æŸ¥çœ‹æ—¥å¿—å¤§å°
journalctl --disk-usage

# æ¸…ç†æ—§æ—¥å¿—
journalctl --vacuum-time=7d

# å¤‡ä»½æ•°æ®åº“
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend
mkdir -p data/backup
cp data/database.sqlite data/backup/database_$(date +%Y%m%d).sqlite
cp data/medical.db data/backup/medical_$(date +%Y%m%d).db
```

### æ€§èƒ½ç›‘æ§

```bash
# æŸ¥çœ‹å‰ç«¯è¿›ç¨‹èµ„æºå ç”¨
ps aux | grep "entry.mjs"

# æŸ¥çœ‹åç«¯è¿›ç¨‹èµ„æºå ç”¨
ps aux | grep "server.js"

# å®æ—¶ç›‘æ§æ‰€æœ‰Nodeè¿›ç¨‹
top -p $(pgrep -f "entry.mjs" | tr '\n' ',')$(pgrep -f "server.js")

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# æ£€æŸ¥CPUä½¿ç”¨
uptime
```

---

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. å‰ç«¯æ— æ³•è®¿é—®

```bash
# æ£€æŸ¥å‰ç«¯æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical.service

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
journalctl -u vietnam-medical.service -n 50

# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tlnp | grep :5001

# é‡å¯å‰ç«¯æœåŠ¡
systemctl restart vietnam-medical.service
```

#### 2. åç«¯APIæ— æ³•è®¿é—®

```bash
# æ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical-backend.service

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
journalctl -u vietnam-medical-backend.service -n 50

# æµ‹è¯•API
curl http://localhost:5002/health

# é‡å¯åç«¯æœåŠ¡
systemctl restart vietnam-medical-backend.service
```

#### 3. æ•°æ®åº“é”™è¯¯

```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
ls -la /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/

# ä¿®å¤æƒé™
chown -R root:root /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/

# æ£€æŸ¥æ•°æ®åº“å®Œæ•´æ€§
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite "PRAGMA integrity_check;"

# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend
npm run init-db
```

#### 4. SSLè¯ä¹¦é—®é¢˜

```bash
# æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯
certbot certificates

# æŸ¥çœ‹è¯ä¹¦è¯¦æƒ…
openssl s_client -connect vietbeauty.top:443 -servername vietbeauty.top 2>/dev/null | \
  openssl x509 -noout -dates

# æµ‹è¯•è¯ä¹¦ç»­æœŸ
certbot renew --dry-run

# æ‰‹åŠ¨ç»­æœŸ
certbot renew
```

#### 5. Nginxé…ç½®é—®é¢˜

```bash
# æµ‹è¯•Nginxé…ç½®
nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/error.log

# é‡å¯Nginx
systemctl restart nginx

# æŸ¥çœ‹Nginxé…ç½®
cat /etc/nginx/conf.d/vietbeauty.conf
```

#### 6. DQAæœåŠ¡ä¸å·¥ä½œ

```bash
# æ£€æŸ¥DQAçŠ¶æ€
curl http://localhost:5002/api/dqa/status

# æŸ¥çœ‹åç«¯æ—¥å¿—
journalctl -u vietnam-medical-backend.service -n 100 | grep -i dqa

# æ‰‹åŠ¨è§¦å‘ç”Ÿæˆ
curl -X POST http://localhost:5002/api/dqa/generate

# æŸ¥çœ‹ç”Ÿæˆæ•°æ®
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT COUNT(*) FROM knowledge WHERE source='dqa';"
```

### ç´§æ€¥æ¢å¤

#### å®Œå…¨æ— æ³•è®¿é—®

```bash
# 1. æ£€æŸ¥æ‰€æœ‰æœåŠ¡
systemctl status vietnam-medical.service vietnam-medical-backend.service nginx.service

# 2. é‡å¯æ‰€æœ‰æœåŠ¡
systemctl restart vietnam-medical.service vietnam-medical-backend.service nginx.service

# 3. ç­‰å¾…5ç§’åé‡æ–°æµ‹è¯•
sleep 5

# 4. æ£€æŸ¥è®¿é—®
curl -I https://vietbeauty.top

# 5. å¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œé‡æ–°è¿è¡Œéƒ¨ç½²è„šæœ¬
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® && ./deploy.sh
```

#### æ•°æ®åº“æŸå

```bash
# 1. åœæ­¢åç«¯æœåŠ¡
systemctl stop vietnam-medical-backend.service

# 2. å¤‡ä»½å½“å‰æ•°æ®åº“
cp /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
   /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database_corrupted_$(date +%Y%m%d_%H%M%S).sqlite

# 3. é‡æ–°åˆå§‹åŒ–
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend
npm run init-db

# 4. å¯åŠ¨æœåŠ¡
systemctl start vietnam-medical-backend.service

# 5. éªŒè¯
curl http://localhost:5002/health
```

---

## è®¿é—®ä¿¡æ¯

### ç”Ÿäº§è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| **å®˜æ–¹ç½‘ç«™** | https://vietbeauty.top | â­ æ¨èä½¿ç”¨ |
| **å¤‡ç”¨åŸŸå** | https://www.vietbeauty.top | å¤‡ç”¨ |
| **IPè®¿é—®** | http://47.237.79.9:5001 | ç›´æ¥IPè®¿é—® |
| **åç«¯API** | http://47.237.79.9:5002 | ä»…é™å†…ç½‘ |

### APIç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/health` | GET | å¥åº·æ£€æŸ¥ |
| `/api/info` | GET | APIä¿¡æ¯ |
| `/api/hospitals` | GET | è·å–åŒ»é™¢åˆ—è¡¨ |
| `/api/knowledge` | GET | è·å–é—®ç­”åˆ—è¡¨ |
| `/api/user-shares` | GET | è·å–ç”¨æˆ·åˆ†äº« |
| `/api/dqa/status` | GET | DQAæœåŠ¡çŠ¶æ€ |
| `/api/dqa/stats` | GET | DQAç»Ÿè®¡ä¿¡æ¯ |

---

## å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤

```bash
# ä¸€é”®éƒ¨ç½²
cd /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›® && ./deploy.sh

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
systemctl status vietnam-medical.service vietnam-medical-backend.service nginx.service

# é‡å¯æ‰€æœ‰æœåŠ¡
systemctl restart vietnam-medical.service vietnam-medical-backend.service nginx.service

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
journalctl -u vietnam-medical.service -u vietnam-medical-backend.service -f

# æµ‹è¯•å‰ç«¯
curl -I https://vietbeauty.top

# æµ‹è¯•åç«¯
curl http://localhost:5002/health

# æŸ¥çœ‹DQAçŠ¶æ€
curl http://localhost:5002/api/dqa/status

# æŸ¥çœ‹æ•°æ®åº“ç»Ÿè®¡
sqlite3 /root/è¶Šå—åŒ»ç–—æ•´å½¢é¡¹ç›®/backend/data/database.sqlite \
  "SELECT source, COUNT(*) FROM knowledge GROUP BY source;"
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-10-26 15:50  
**çŠ¶æ€**: âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­  
**å…³é”®æ”¹è¿›**:
- âœ… æ•°æ®åº“åˆ†ç¦»è¯¦ç»†è¯´æ˜
- âœ… å®Œæ•´çš„æ¶æ„å›¾å’Œæ•°æ®æµå‘
- âœ… DQAç³»ç»Ÿé›†æˆæ–‡æ¡£
- âœ… æ™ºèƒ½ä½“ç³»ç»Ÿè¿ç»´æŒ‡å—
- âœ… è¯¦ç»†çš„æ•…éšœæ’é™¤æ–¹æ¡ˆ

